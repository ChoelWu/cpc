define(function(require,exports,module){module.exports={currIndex:-1,tipsPanel:$(".js-search-tips"),searchInput:$(".js-search-ipt"),watchUpDown:function(a){this.tipsPanel.is("hidden")||(40==a&&(this.setCurrIndex("down"),this.itemSwitch()),38==a&&(this.setCurrIndex("up"),this.itemSwitch()))},setCurrIndex:function(a){var c=this.tipsPanel.find(".li"),h=c.length;this.currIndex="up"===a?this.currIndex>-1?this.currIndex-1:h-1:this.currIndex<h-1?this.currIndex+1:-1},itemSwitch:function(){var a=this.tipsPanel.find(".li"),c=null,h="";a.removeClass("active"),this.currIndex>-1&&(c=a.eq(this.currIndex),c.addClass("active"),h=c.find("a").html(),this.setTriggerValue(h))},setTriggerValue:function(a){this.searchInput.val(a)},associative:function(a){var c=this;$.ajax({type:"GET",url:"/search/history?words="+a,dataType:"json",success:function(a){if(a.data.length>0){if(""==c.searchInput.val())return;var h=c.getAssociativeDom(a.data);c.tipsPanel.html(h).show()}else c.tipsPanel.hide()}})},words:function(){return OP_CONFIG.$words?OP_CONFIG.$words:""},location:function(a){""==a&&(a=this.words()),location.href=this.returnUrl()+encodeURIComponent(a)},returnUrl:function(){var a="",c=OP_CONFIG.page;switch(c){case"wenda":a="/search/wenda?words=";break;case"article":a="/search/article?words=";break;case"wiki":a="/search/wiki?words=";break;default:a="/search/?words="}return a},History:{is:!1,dom:""},searchAreaDom:function(a){var c="";c='<div style="padding: 0 24px 48px">',c+='<p class="search-history-words">最近搜索</p>';for(var i=0;i<a.length;i++)c+='<li><a href="/search/?words='+a[i].word+'">'+a[i].word+"</a></li>";return c+="</div>"},getAssociativeDom:function(a){for(var c="",i=0;i<a.length;i++)c+='<div class="li"><a href="/search/?words='+a[i].word+'">'+a[i].word+"</a></div>";return c},setSearchHistory:function(){var a=this;return isLogin?a.History.is?(this.tipsPanel.html(a.History.dom),void this.tipsPanel.show()):void this.getSearchHistory(function(c){if(c.data.length>0){var h=a.searchAreaDom(c.data);a.tipsPanel.html(h),a.tipsPanel.show(),a.History.is=!0,a.History.dom=h}}):!1},getSearchHistory:function(a){$.ajax({type:"GET",url:"/index/searchhistory",dataType:"json",success:function(c){a&&a(c)}})}}});